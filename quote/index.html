<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Request a Quote | Cordova Courier</title>
  <meta name="description" content="Request a delivery quote with Cordova Courier. Fill out the form and our dispatch team will get back to you promptly.">
  <link rel="stylesheet" href="/css/request-a-quote.css">

  <!-- ✅ Google Maps API loaded ONCE inside <head> -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPlkZs0JztcTWQLVaNc1ZOBPJvXxhLtz8&libraries=places"></script>
</head>

<body>

<div class="form-container">
  <!-- ✅ Your full logo, headline, and form goes here (already good) -->
  <!-- ✅ All your form fields stay exactly how you built them -->

  <!-- Your form starts here -->
  <form id="quoteForm" action="YOUR_BACKEND_HANDLER" method="POST">
    <!-- Your full form HTML goes here exactly like you pasted -->
  </form>
</div>

<!-- ✅ Place your custom JavaScript here at the bottom for faster page load -->
<script>
  let pickupAutocomplete, deliveryAutocomplete, companyAutocomplete;

  function initAutocomplete() {
    const options = {
      types: ['geocode', 'establishment']
    };

    companyAutocomplete = new google.maps.places.Autocomplete(
      document.getElementById('companyStreet'),
      options
    );
    companyAutocomplete.addListener('place_changed', function() {
      fillInAddress(companyAutocomplete, 'company');
    });

    pickupAutocomplete = new google.maps.places.Autocomplete(
      document.getElementById('pickupStreet'),
      options
    );
    pickupAutocomplete.addListener('place_changed', function() {
      fillInAddress(pickupAutocomplete, 'pickup');
    });

    deliveryAutocomplete = new google.maps.places.Autocomplete(
      document.getElementById('deliveryStreet'),
      options
    );
    deliveryAutocomplete.addListener('place_changed', function() {
      fillInAddress(deliveryAutocomplete, 'delivery');
    });
  }

  function fillInAddress(autocomplete, prefix) {
    const place = autocomplete.getPlace();
    const components = {
      street_number: '',
      route: '',
      locality: '',
      administrative_area_level_1: '',
      postal_code: '',
      country: ''
    };

    if (place.address_components) {
      place.address_components.forEach(component => {
        const types = component.types;
        if (types.includes('street_number')) {
          components.street_number = component.long_name;
        }
        if (types.includes('route')) {
          components.route = component.long_name;
        }
        if (types.includes('locality')) {
          components.locality = component.long_name;
        }
        if (types.includes('administrative_area_level_1')) {
          components.administrative_area_level_1 = component.short_name;
        }
        if (types.includes('postal_code')) {
          components.postal_code = component.long_name;
        }
        if (types.includes('country')) {
          components.country = component.long_name;
        }
      });
    }

    // Lock Company Name if available
    if (prefix === 'company' && place.name && document.getElementById('companyName').value.trim() === '') {
      document.getElementById('companyName').value = place.name;
    }

    // Set Street Address
    const streetAddress = `${components.street_number} ${components.route}`.trim();
    if (document.getElementById(prefix + 'Street') && streetAddress.trim() !== '') {
      document.getElementById(prefix + 'Street').value = streetAddress;
    }

    if (document.getElementById(prefix + 'City')) {
      document.getElementById(prefix + 'City').value = components.locality;
    }
    if (document.getElementById(prefix + 'State')) {
      document.getElementById(prefix + 'State').value = components.administrative_area_level_1;
    }
    if (document.getElementById(prefix + 'Zip')) {
      document.getElementById(prefix + 'Zip').value = components.postal_code;
    }
    if (document.getElementById(prefix + 'Country')) {
      document.getElementById(prefix + 'Country').value = components.country;
    }

    // Set hidden Latitude and Longitude
    if (place.geometry) {
      if (document.getElementById(prefix + 'Lat')) {
        document.getElementById(prefix + 'Lat').value = place.geometry.location.lat();
      }
      if (document.getElementById(prefix + 'Lng')) {
        document.getElementById(prefix + 'Lng').value = place.geometry.location.lng();
      }
    }
  }

  window.addEventListener('load', initAutocomplete);
</script>

</body>
</html>
